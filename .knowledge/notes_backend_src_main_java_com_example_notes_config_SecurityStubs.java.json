{"is_source_file": true, "format": "Java", "description": "This Java source file defines a utility class 'SecurityStubs' providing stub implementations for Role-based access control (RBAC) and request context handling in a Spring web application. It includes a RequestContext class for storing user and role info via ThreadLocal, a custom annotation @RequiresRole for access restrictions, and a RoleInterceptor that populates context from HTTP headers and enforces role requirements.", "external_files": ["org.springframework.web.servlet.HandlerInterceptor", "org.springframework.web.servlet.config.annotation.WebMvcConfigurer", "org.springframework.web.servlet.config.annotation.InterceptorRegistry", "org.springframework.http.HttpStatus", "jakarta.servlet.http.HttpServletRequest", "org.springframework.web.method.HandlerMethod"], "external_methods": ["StringUtils.hasText", "HttpServletRequest.getHeader", "HttpServletResponse.sendError", "HandlerMethod.getMethodAnnotation", "HandlerMethod.getBeanType"], "published": ["SecurityStubs"], "classes": [{"name": "SecurityStubs", "description": "A final class providing static nested classes and annotations for mock security management including RequestContext, role annotations, and an interceptor for request handling."}, {"name": "SecurityStubs.RequestContext", "description": "A static utility class that manages ThreadLocal storage of user ID and role for the current request."}, {"name": "SecurityStubs.RequiresRole", "description": "Custom annotation to specify required user roles on controller or service methods."}, {"name": "SecurityStubs.RoleInterceptorConfig", "description": "Configuration class implementing WebMvcConfigurer to register the RoleInterceptor."}, {"name": "SecurityStubs.RoleInterceptor", "description": "HandlerInterceptor implementation that populates RequestContext from headers and enforces role restrictions based on @RequiresRole annotations."}], "methods": [{"name": "setUser", "description": "Sets the current user ID in ThreadLocal storage."}, {"name": "getUser", "description": "Retrieves the current user ID, defaulting to 'system' if not set."}, {"name": "setRole", "description": "Sets the current user's role in ThreadLocal storage."}, {"name": "getRole", "description": "Retrieves the current user's role, defaulting to 'USER' if not set."}, {"name": "clear", "description": "Clears the ThreadLocal storage for user and role."}], "calls": ["StringUtils.hasText", "HttpServletRequest.getHeader", "HttpServletResponse.sendError", "HandlerMethod.getMethodAnnotation", "HandlerMethod.getBeanType"], "search-terms": ["SecurityStubs", "RequestContext", "RoleInterceptor", "RequiresRole", "RBAC", "Stub", "Header-based authorization"], "state": 2, "file_id": 9, "knowledge_revision": 22, "git_revision": "", "hash": "101da6c6461eebca4d37f1b60dcfb569", "format-version": 4, "code-base-name": "notes_backend", "filename": "notes_backend/src/main/java/com/example/notes/config/SecurityStubs.java", "revision_history": [{"22": ""}]}